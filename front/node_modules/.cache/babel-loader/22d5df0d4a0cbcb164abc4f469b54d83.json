{"ast":null,"code":"import axios from \"axios\";\nexport default {\n  name: \"User\",\n\n  data() {\n    return {\n      userName: window.localStorage.getItem(\"userName\"),\n      logoUrl: \"../assets/images/logo.png\",\n      isAdmin: window.localStorage.getItem(\"isAdmin\"),\n      index: 1,\n      form: {\n        name: '',\n        region: '',\n        date1: '',\n        date2: '',\n        delivery: false,\n        type: [],\n        resource: '',\n        desc: ''\n      },\n      order: {\n        name: window.localStorage.getItem(\"userName\"),\n        id: window.localStorage.getItem(\"id\"),\n        requestVol: 0,\n        startVol: 0,\n        chargingMode: \"\",\n        carVol: 0\n      },\n      carStatus: 0,\n      chargePileID: \"暂未加入排队序列\",\n      carsAhead: \"暂未加入排队序列\",\n      queueNo: 0,\n      number: \"暂未加入排队序列\",\n      area: \"暂未加入排队序列\",\n      usedVol: 0,\n      usedCast: 0,\n      car_per: 0,\n      ele_per: 0,\n      totalCar: 0,\n      isRunning: false,\n      timer: null,\n      timer2: null,\n      vol: 0,\n      menu: {},\n      timerList: []\n    };\n  },\n\n  created() {},\n\n  mounted() {\n    this.cancle();\n    window.clearInterval(this.timer);\n    const userName = window.localStorage.getItem(\"userName\");\n    console.log(userName);\n  },\n\n  methods: {\n    cancle() {\n      var _this = this;\n\n      axios.post('http://127.0.0.1:5000/usr/cancel', _this.order).then(function (response) {\n        window.clearInterval(_this.timer);\n        window.clearInterval(_this.timer2);\n        console.log(response);\n        _this.isRunning = false;\n      });\n    },\n\n    perSecond() {\n      const _this = this;\n\n      axios.post('http://127.0.0.1:5000/usr/car-status', _this.order).then(function (response) {\n        _this.carsAhead = response.data.carsAhead;\n        console.log(_this.order.userName, response);\n\n        switch (response.data.status) {\n          case 'charging':\n            window.clearInterval(_this.timer);\n            axios.post('http://127.0.0.1:5000/usr/start-charging', _this.order).then(function (response) {\n              console.log(response.data);\n              _this.timer2 = setInterval(function () {\n                _this.perSecond2();\n              }, 1000);\n            });\n        }\n      });\n    },\n\n    perSecond2() {\n      const _this = this;\n\n      axios.post('http://127.0.0.1:5000/usr/car-status', _this.order).then(function (response) {\n        _this.carsAhead = response.data.carsAhead;\n\n        if (response.data.status == 'charging-finished') {\n          window.clearInterval(_this.timer2);\n          axios.post('http://127.0.0.1:5000/usr/end-charging', _this.order).then(function (response) {\n            console.log(_this.order.userName, response);\n            _this.isRunning = false;\n            _this.menu = response.data;\n          });\n        } else {\n          _this.vol += response.data.incVol;\n          _this.ele_per = _this.vol / _this.order.carVol * 100;\n        }\n\n        console.log(response);\n      });\n    },\n\n    handleSelect(key, keyPath) {\n      this.index = key;\n      console.log(this.index);\n    },\n\n    onSubmit() {\n      var mode = [100, 150, 200, 250, 300];\n\n      var _this = this;\n\n      _this.order.carVol = mode[Math.floor(Math.random() * 5)];\n      _this.order.startVol = Math.floor(Math.random() * (_this.order.carVol + 1));\n      _this.vol = _this.order.startVol;\n      console.log(this.order);\n      axios.post('http://127.0.0.1:5000/usr/getqueueno', _this.order).then(function (response) {\n        console.log(response);\n        let data = response.data;\n        _this.carStatus = data.carStatus;\n        _this.chargePileID = data.chargePileID;\n        _this.carsAhead = data.carsAhead + \"\";\n        _this.queueNo = data.queueNo;\n        _this.number = data.carsAhead + 1 + \"\";\n        _this.totalCar = data.carsAhead + 1;\n        _this.car_per = (data.carsAhead + 1 - data.carsAhead) / (data.carsAhead + 1) * 100;\n        _this.ele_per = _this.order.startVol / _this.order.carVol * 100;\n        _this.isRunning = true;\n        console.log(_this.car_per);\n\n        switch (data.carStatus) {\n          case 3:\n            _this.area = \"优先等待区\";\n            break;\n\n          case 2:\n            _this.area = \"等待区\";\n            break;\n\n          case 1:\n            _this.area = \"充电等待区\";\n            break;\n\n          default:\n            _this.area = \"充电区\";\n            break;\n        }\n\n        _this.timer = setInterval(function () {\n          _this.perSecond();\n        }, 1000);\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["axios","name","data","userName","window","localStorage","getItem","logoUrl","isAdmin","index","form","region","date1","date2","delivery","type","resource","desc","order","id","requestVol","startVol","chargingMode","carVol","carStatus","chargePileID","carsAhead","queueNo","number","area","usedVol","usedCast","car_per","ele_per","totalCar","isRunning","timer","timer2","vol","menu","timerList","created","mounted","cancle","clearInterval","console","log","methods","_this","post","then","response","perSecond","status","setInterval","perSecond2","incVol","handleSelect","key","keyPath","onSubmit","mode","Math","floor","random"],"sourceRoot":"","sources":["D:\\software_proj\\front\\src\\views\\User.vue"],"sourcesContent":["<template>\r\n  <div class=\"chat\">\r\n\r\n    <div>\r\n      <el-container>\r\n        <el-aside width=\"200px\" style=\"background-color: transparent; border-radius: 5px;\">\r\n\r\n          <el-menu\r\n              default-active=\"1\"\r\n              class=\"el-menu-vertical-demo\"\r\n              @open=\"handleOpen\"\r\n              @close=\"handleClose\"\r\n              background-color=\"#FFFFFF66\"\r\n              @select=\"handleSelect\"\r\n          >\r\n            <el-menu-item index=\"1\">\r\n              <template #title>\r\n                <el-icon>\r\n                  <location/>\r\n                </el-icon>\r\n                <span>个人信息</span>\r\n              </template>\r\n            </el-menu-item>\r\n            <el-menu-item index=\"2\">\r\n              <el-icon>\r\n                <icon-menu/>\r\n              </el-icon>\r\n              <span>充电详单</span>\r\n            </el-menu-item>\r\n\r\n            <el-menu-item index=\"3\">\r\n              <el-icon>\r\n                <icon-menu/>\r\n              </el-icon>\r\n              <span>充电界面</span>\r\n            </el-menu-item>\r\n\r\n          </el-menu>\r\n        </el-aside>\r\n        <el-main>\r\n          <div v-if=\"index == 1\">\r\n            <el-card>\r\n              <el-row>\r\n                <el-col :span=\"8\">\r\n                  <el-avatar :size=\"100\"\r\n                             src=\"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png\"></el-avatar>\r\n                </el-col>\r\n              </el-row>\r\n              <el-form :model=\"form\" label-width=\"120px\" style=\"margin-top: 20px;\">\r\n                <el-form-item label=\"用户名：\">\r\n                  <div>{{ userName }}</div>\r\n                </el-form-item>\r\n              </el-form>\r\n            </el-card>\r\n          </div>\r\n          <div v-if=\"index == 2\">\r\n            <el-card>\r\n              <el-row>\r\n                <el-col :span=\"8\">\r\n                  <el-avatar :size=\"100\"\r\n                             src=\"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png\"></el-avatar>\r\n                </el-col>\r\n              </el-row>\r\n              <el-form :model=\"form\" label-width=\"120px\" style=\"margin-top: 20px;\">\r\n                <el-form-item label=\"用户名：\">\r\n                  <div>{{ userName }}</div>\r\n                </el-form-item>\r\n              </el-form>\r\n            </el-card>\r\n          </div>\r\n          <div v-if=\"index == 3\">\r\n            <el-card>\r\n              <el-form :model=\"order\" label-width=\"120px\">\r\n                <el-form-item label=\"充电电量\">\r\n                  <el-input v-model=\"order.requestVol\"/>\r\n                </el-form-item>\r\n                <el-form-item label=\"充电模式\">\r\n                  <el-select v-model=\"order.chargingMode\" placeholder=\"请选择你的充电模式\">\r\n                    <el-option label=\"快充\" value=\"F\"/>\r\n                    <el-option label=\"慢充\" value=\"T\"/>\r\n                  </el-select>\r\n                </el-form-item>\r\n\r\n                <el-form-item>\r\n                  <el-button v-if=\"isRunning == false\" type=\"primary\" @click=\"onSubmit\">请求充电</el-button>\r\n                  <el-button v-else type=\"primary\" @click=\"onSubmit\" disabled>请求充电</el-button>\r\n                  <el-button @click=\"cancle\">结束充电</el-button>\r\n                </el-form-item>\r\n              </el-form>\r\n            </el-card>\r\n            <el-card style=\"margin-top: 20px\">\r\n              <el-row>\r\n                <el-col :span=\"6\">车辆标号：</el-col>\r\n                <el-col :span=\"5\">{{order.id - 2}}</el-col>\r\n              </el-row>\r\n              <el-row>\r\n                <el-col :span=\"6\">本车排队代码：</el-col>\r\n                <el-col :span=\"5\">{{ number }}</el-col>\r\n              </el-row>\r\n              <el-row>\r\n                <el-col :span=\"6\">前车等待数量：</el-col>\r\n                <el-col :span=\"5\">{{ carsAhead }}</el-col>\r\n              </el-row>\r\n              <el-row>\r\n                <el-col :span=\"6\">当前所在区域：</el-col>\r\n                <el-col :span=\"5\">{{ area }}</el-col>\r\n              </el-row>\r\n              <el-row>\r\n                <el-col :span=\"6\">使用充电桩：</el-col>\r\n                <el-col :span=\"5\">{{ chargePileID }}</el-col>\r\n              </el-row>\r\n              <el-row>\r\n                <el-col :span=\"6\">当前使用电量：</el-col>\r\n                <el-col :span=\"5\">{{ (usedVol).toFixed(2) }}</el-col>\r\n              </el-row>\r\n              <el-row>\r\n                <el-col :span=\"6\">当前费用：</el-col>\r\n                <el-col :span=\"5\">{{ (usedCost).toFixed(2) }}</el-col>\r\n              </el-row>\r\n              <el-row>\r\n                <el-col :span=\"6\">等待前车进度：</el-col>\r\n                <el-col :span=\"5\">\r\n                  <el-progress\r\n                      :text-inside=\"true\"\r\n                      :stroke-width=\"20\"\r\n                      :percentage=\"car_per\"\r\n                      status=\"exception\"\r\n                      color=\"blue\"\r\n                  >\r\n                    <span>排队进度</span>\r\n                  </el-progress>\r\n                </el-col>\r\n              </el-row>\r\n              <el-row>\r\n                <el-col :span=\"6\">汽车充电进度：</el-col>\r\n                <el-col :span=\"5\">\r\n                  <el-progress type=\"dashboard\" :percentage=\"ele_per\" :indeterminate=\"true\">\r\n                    <template #default=\"{ percentage }\">\r\n                      <span class=\"percentage-value\">{{ percentage.toFixed(2) }}%</span>\r\n\r\n                    </template>\r\n                  </el-progress>\r\n                </el-col>\r\n              </el-row>\r\n              <button @click=\"endCharging(index)\">结束充电</button>\r\n            </el-card>\r\n          </div>\r\n\r\n\r\n        </el-main>\r\n      </el-container>\r\n    </div>\r\n\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n  name: \"User\",\r\n  data() {\r\n    return {\r\n      userName: window.localStorage.getItem(\"userName\"),\r\n      logoUrl: \"../assets/images/logo.png\",\r\n      isAdmin: window.localStorage.getItem(\"isAdmin\"),\r\n      index: 1,\r\n      form: {\r\n        name: '',\r\n        region: '',\r\n        date1: '',\r\n        date2: '',\r\n        delivery: false,\r\n        type: [],\r\n        resource: '',\r\n        desc: ''\r\n      },\r\n      order: {\r\n        name: window.localStorage.getItem(\"userName\"),\r\n        id: window.localStorage.getItem(\"id\"),\r\n        requestVol: 0,\r\n        startVol: 0,\r\n        chargingMode: \"\",\r\n        carVol: 0\r\n      },\r\n      carStatus: 0,\r\n      chargePileID: \"暂未加入排队序列\",\r\n      carsAhead: \"暂未加入排队序列\",\r\n      queueNo: 0,\r\n      number: \"暂未加入排队序列\",\r\n      area: \"暂未加入排队序列\",\r\n      usedVol: 0,\r\n      usedCast: 0,\r\n      car_per: 0,\r\n      ele_per: 0,\r\n      totalCar: 0,\r\n      isRunning: false,\r\n      timer: null,\r\n      timer2: null,\r\n      vol: 0,\r\n      menu: {},\r\n      timerList: []\r\n    }\r\n  },\r\n  created() {\r\n\r\n  },\r\n  mounted() {\r\n    this.cancle()\r\n\r\n    window.clearInterval(this.timer)\r\n    const userName = window.localStorage.getItem(\"userName\")\r\n    console.log(userName)\r\n  },\r\n  methods: {\r\n\r\n    cancle() {\r\n      var _this = this\r\n      axios.post('http://127.0.0.1:5000/usr/cancel', _this.order).then(\r\n          function (response) {\r\n            window.clearInterval(_this.timer)\r\n            window.clearInterval(_this.timer2)\r\n            console.log(response)\r\n            _this.isRunning = false\r\n          }\r\n      )\r\n    },\r\n    perSecond() {\r\n      const _this = this\r\n      axios.post('http://127.0.0.1:5000/usr/car-status', _this.order).then(\r\n          function (response) {\r\n            _this.carsAhead = response.data.carsAhead\r\n            console.log(_this.order.userName, response)\r\n            switch (response.data.status){\r\n              case 'charging':\r\n                window.clearInterval(_this.timer)\r\n                axios.post('http://127.0.0.1:5000/usr/start-charging', _this.order).then(\r\n                    function (response) {\r\n                      console.log(response.data)\r\n                      _this.timer2 = setInterval(function () {\r\n                        _this.perSecond2()\r\n                      }, 1000)\r\n                    }\r\n                )\r\n            }\r\n          }\r\n      )\r\n    },\r\n    perSecond2() {\r\n      const _this = this\r\n      axios.post('http://127.0.0.1:5000/usr/car-status', _this.order).then(\r\n          function (response) {\r\n            _this.carsAhead = response.data.carsAhead\r\n            if (response.data.status == 'charging-finished'){\r\n              window.clearInterval(_this.timer2)\r\n              axios.post('http://127.0.0.1:5000/usr/end-charging', _this.order).then(\r\n                  function (response) {\r\n                    console.log(_this.order.userName, response)\r\n                    _this.isRunning = false\r\n                    _this.menu = response.data\r\n                  }\r\n              )\r\n            } else {\r\n              _this.vol += response.data.incVol\r\n              _this.ele_per = (_this.vol / _this.order.carVol) * 100\r\n            }\r\n            console.log(response)\r\n            }\r\n      )\r\n    },\r\n    handleSelect(key, keyPath) {\r\n      this.index = key\r\n      console.log(this.index)\r\n    },\r\n    onSubmit() {\r\n      var mode = [100, 150, 200, 250, 300]\r\n      var _this = this\r\n      _this.order.carVol = mode[Math.floor(Math.random() * 5)]\r\n      _this.order.startVol = Math.floor(Math.random() * (_this.order.carVol + 1))\r\n      _this.vol = _this.order.startVol\r\n      console.log(this.order)\r\n      axios.post('http://127.0.0.1:5000/usr/getqueueno', _this.order).then(\r\n          function (response) {\r\n            console.log(response)\r\n            let data = response.data\r\n            _this.carStatus = data.carStatus\r\n            _this.chargePileID = data.chargePileID\r\n            _this.carsAhead = data.carsAhead + \"\"\r\n            _this.queueNo = data.queueNo\r\n            _this.number = data.carsAhead + 1 + \"\"\r\n            _this.totalCar = data.carsAhead + 1\r\n            _this.car_per = (data.carsAhead + 1 - data.carsAhead) / (data.carsAhead + 1) * 100\r\n            _this.ele_per = (_this.order.startVol / _this.order.carVol) * 100\r\n            _this.isRunning = true\r\n            console.log(_this.car_per)\r\n            switch (data.carStatus) {\r\n              case 3:\r\n                _this.area = \"优先等待区\"\r\n                break;\r\n              case 2:\r\n                _this.area = \"等待区\"\r\n                break;\r\n              case 1:\r\n                _this.area = \"充电等待区\"\r\n                break;\r\n              default:\r\n                _this.area = \"充电区\"\r\n                break;\r\n            }\r\n\r\n            _this.timer = setInterval(function () {\r\n              _this.perSecond()\r\n            }, 1000)\r\n\r\n          }\r\n      )\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.chat {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 200%;\r\n  z-index: -1;\r\n\r\n  background-image: linear-gradient(45deg, rgba(0, 200, 255, 0.4) 0%, rgba(132, 43, 171, 0.4) 100%);\r\n}\r\n\r\n#title {\r\n  color: white;\r\n  position: center !important;\r\n}\r\n\r\n.contain {\r\n  background: rgba(34, 34, 34, 0.5) !important;\r\n}\r\n\r\n.m-card {\r\n  margin-right: 40px;\r\n  background-image: linear-gradient(45deg, rgba(0, 200, 255, 0.4) 0%, rgba(132, 43, 171, 0.4) 100%);\r\n}\r\n\r\n.ourpage {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  z-index: -1;\r\n  border-radius: 5px;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}