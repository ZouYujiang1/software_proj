{"ast":null,"code":"import axios from \"axios\";\nexport default {\n  name: \"Test\",\n\n  data() {\n    return {\n      userName: window.localStorage.getItem(\"userName\"),\n      logoUrl: \"../assets/images/logo.png\",\n      isAdmin: window.localStorage.getItem(\"isAdmin\"),\n      index: 1,\n      form: {\n        name: '',\n        region: '',\n        date1: '',\n        date2: '',\n        delivery: false,\n        type: [],\n        resource: '',\n        desc: ''\n      },\n      order: {\n        name: window.localStorage.getItem(\"userName\"),\n        id: window.localStorage.getItem(\"id\"),\n        requestVol: 0,\n        startVol: 0,\n        chargingMode: \"\",\n        carVol: 0\n      },\n      carStatus: 0,\n      chargePileID: \"暂未加入排队序列\",\n      carsAhead: \"暂未加入排队序列\",\n      queueNo: 0,\n      number: \"暂未加入排队序列\",\n      area: \"暂未加入排队序列\",\n      car_per: 0,\n      ele_per: 0,\n      totalCar: 0,\n      isRunning: false,\n      timer: null,\n      timer2: null,\n      vol: 0,\n      menu: {},\n      timerList: [],\n      timerList2: [],\n      list: [],\n      ceshi: []\n    };\n  },\n\n  created() {},\n\n  mounted() {},\n\n  methods: {\n    test() {\n      var _this = this;\n\n      var i = 0;\n      var timer = setInterval(function () {\n        if (i == 5) {\n          window.clearInterval(timer);\n        }\n\n        var j = i + 3;\n        var temp = {};\n        temp.name = j + '';\n        temp.id = j;\n        temp.requestVol = 10;\n        temp.chargingMode = 'F';\n        temp.modeChoose = 'A';\n        temp.time = '2022/6/16 13:56:00';\n\n        _this.startTest(i, temp);\n\n        i++;\n      }, 2000);\n    },\n\n    startTest(i, order) {\n      var _this = this;\n\n      _this.ceshi.push(order);\n\n      switch (order.modeChoose) {\n        case 'A':\n          _this.onSubmit(i, order);\n\n          break;\n\n        case 'B':\n          _this.fix(i, order);\n\n          break;\n\n        case 'C':\n          _this.change(i, order);\n\n          break;\n      }\n    },\n\n    sleep(numberMillis) {\n      var now = new Date();\n      var exitTime = now.getTime() + numberMillis;\n\n      while (true) {\n        now = new Date();\n        if (now.getTime() > exitTime) return true;\n      }\n    },\n\n    cancle() {\n      var _this = this;\n\n      axios.post('http://127.0.0.1:5000/usr/cancel', _this.order).then(function (response) {\n        window.clearInterval(_this.timer);\n        window.clearInterval(_this.timer2);\n        _this.isRunning = false;\n      });\n    },\n\n    perSecond(i) {\n      const _this = this;\n\n      axios.post('http://127.0.0.1:5000/usr/car-status', _this.list[i].order).then(function (response) {\n        _this.list[i].carsAhead = response.data.carsAhead;\n        console.log(\"V\", i + 1, response.data);\n\n        switch (response.data.carStatus) {\n          case 3:\n            _this.list[i].area = \"优先等待区\";\n            break;\n\n          case 2:\n            _this.list[i].area = \"等待区\";\n            break;\n\n          case 1:\n            _this.list[i].number = null;\n            _this.list[i].carsAhead = null;\n            _this.list[i].area = \"充电等待区\";\n            break;\n\n          default:\n            _this.list[i].area = \"充电区\";\n            break;\n        }\n\n        _this.list[i].chargePileID = response.data.chargePileID;\n\n        switch (response.data.status) {\n          case 'charging':\n            window.clearInterval(_this.timerList[i]);\n            axios.post('http://127.0.0.1:5000/usr/start-charging', _this.list[i].order).then(function (response) {\n              _this.list[i].queueNo = null;\n              console.log(\"V\", i + 1, response.data);\n\n              switch (response.data.carStatus) {\n                case 3:\n                  _this.list[i].area = \"优先等待区\";\n                  break;\n\n                case 2:\n                  _this.list[i].area = \"等待区\";\n                  break;\n\n                case 1:\n                  _this.list[i].area = \"充电等待区\";\n                  break;\n\n                default:\n                  _this.list[i].area = \"充电区\";\n                  break;\n              }\n\n              _this.timerList2[i] = setInterval(function () {\n                _this.perSecond2(i);\n              }, 1000);\n            });\n        }\n      });\n    },\n\n    perSecond2(i) {\n      const _this = this;\n\n      axios.post('http://127.0.0.1:5000/usr/car-status', _this.list[i].order).then(function (response) {\n        _this.list[i].number = null;\n        _this.list[i].chargePileID = response.data.chargePileID;\n\n        switch (response.data.carStatus) {\n          case 3:\n            _this.list[i].carsAhead = response.data.carsAhead;\n            _this.list[i].area = \"优先等待区\";\n            break;\n\n          case 2:\n            _this.list[i].area = \"等待区\";\n            break;\n\n          case 1:\n            _this.list[i].number = null;\n            _this.list[i].carsAhead = null;\n            _this.list[i].area = \"充电等待区\";\n            break;\n\n          default:\n            _this.list[i].area = \"充电区\";\n            break;\n        }\n\n        if (response.data.status === 'charging-finished') {\n          _this.list[i].carsAhead = response.data.carsAhead;\n          _this.list[i].chargePileID = response.data.chargePileID;\n          window.clearInterval(_this.timerList2[i]); // _this.list[i] = null\n\n          console.log(\"V\", i + 1, response.data);\n          axios.post('http://127.0.0.1:5000/usr/end-charging', _this.list[i].order).then(function (response) {\n            console.log(\"V\", i + 1, response.data.status);\n            _this.list[i].area = '离开';\n            _this.list[i].chargePileID = null;\n            _this.list[i].carsAhead = null;\n            _this.isRunning = false;\n            _this.menu = response.data;\n          }).catch(function (err) {\n            console.log(err);\n          });\n        } else if (response.data.status === 'charging') {\n          _this.list[i].vol += response.data.incVol;\n          _this.list[i].ele_per = _this.list[i].vol / _this.list[i].carVol * 100;\n        } else if (response.data.status === 'prewaiting') {} else {}\n      });\n    },\n\n    handleSelect(key, keyPath) {\n      this.index = key;\n    },\n\n    onSubmit(i, order) {\n      var mode = [100, 150, 200, 250, 300];\n\n      var _this = this;\n\n      _this.order.carVol = mode[Math.floor(Math.random() * 5)];\n      _this.order.startVol = Math.floor(Math.random() * (order.carVol + 1));\n      _this.vol = order.startVol;\n      axios.post('http://127.0.0.1:5000/usr/getqueueno', order).then(function (response) {\n        let data = response.data;\n        _this.carStatus = data.carStatus;\n        _this.chargePileID = data.chargePileID;\n        _this.carsAhead = data.carsAhead + \"\";\n        _this.queueNo = data.queueNo;\n        _this.number = data.carsAhead + 1 + \"\";\n        _this.totalCar = data.carsAhead + 1;\n        _this.car_per = (data.carsAhead + 1 - data.carsAhead) / (data.carsAhead + 1) * 100;\n        _this.ele_per = _this.order.startVol / _this.order.carVol * 100;\n        _this.isRunning = true;\n\n        switch (data.carStatus) {\n          case 3:\n            _this.area = \"优先等待区\";\n            break;\n\n          case 2:\n            _this.area = \"等待区\";\n            break;\n\n          case 1:\n            _this.area = \"充电等待区\";\n            break;\n\n          default:\n            _this.area = \"充电区\";\n            break;\n        }\n\n        var obj = {};\n        obj.number = data.carsAhead + 1 + \"\";\n        obj.carsAhead = data.carsAhead + \"\";\n        obj.area = _this.area;\n        obj.chargePileID = data.chargePileID;\n        obj.car_per = (data.carsAhead + 1 - data.carsAhead) / (data.carsAhead + 1) * 100;\n        obj.carVol = mode[Math.floor(Math.random() * 5)];\n        obj.startVol = Math.floor(Math.random() * (obj.carVol + 1));\n        obj.ele_per = obj.startVol / obj.carVol * 100;\n        obj.vol = obj.startVol;\n        obj.order = order;\n        obj.order.startVol = obj.startVol;\n        obj.order.carVol = obj.carVol;\n\n        _this.list.push(obj);\n\n        _this.timerList[i] = setInterval(function () {\n          _this.perSecond(i);\n        }, 1000);\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["axios","name","data","userName","window","localStorage","getItem","logoUrl","isAdmin","index","form","region","date1","date2","delivery","type","resource","desc","order","id","requestVol","startVol","chargingMode","carVol","carStatus","chargePileID","carsAhead","queueNo","number","area","car_per","ele_per","totalCar","isRunning","timer","timer2","vol","menu","timerList","timerList2","list","ceshi","created","mounted","methods","test","_this","i","setInterval","clearInterval","j","temp","modeChoose","time","startTest","push","onSubmit","fix","change","sleep","numberMillis","now","Date","exitTime","getTime","cancle","post","then","response","perSecond","console","log","status","perSecond2","catch","err","incVol","handleSelect","key","keyPath","mode","Math","floor","random","obj"],"sourceRoot":"","sources":["D:\\software_proj\\front\\src\\views\\Test.vue"],"sourcesContent":["<template>\r\n  <div class=\"chat\">\r\n\r\n    <div>\r\n      <el-container>\r\n        <el-aside width=\"200px\" style=\"background-color: transparent; border-radius: 5px;\">\r\n\r\n          <el-menu\r\n              default-active=\"1\"\r\n              class=\"el-menu-vertical-demo\"\r\n              @open=\"handleOpen\"\r\n              @close=\"handleClose\"\r\n              background-color=\"#FFFFFF66\"\r\n              @select=\"handleSelect\"\r\n          >\r\n\r\n\r\n            <el-menu-item index=\"1\">\r\n              <el-icon>\r\n                <icon-menu/>\r\n              </el-icon>\r\n              <span>测试界面</span>\r\n            </el-menu-item>\r\n\r\n          </el-menu>\r\n          <el-card>\r\n            <template #header>\r\n              <div class=\"card-header\">\r\n                <span>测试用例</span>\r\n              </div>\r\n            </template>\r\n            <div v-for=\"(i, index) in ceshi\" class=\"text item\" style=\"padding-bottom: 20px\">{{index}} : {{i}}</div>\r\n          </el-card>\r\n        </el-aside>\r\n        <el-main>\r\n\r\n          <div v-if=\"index == 1\">\r\n            <el-row>\r\n              <el-col\r\n\r\n                  :key=\"o\"\r\n                  :span=\"10\"\r\n                  :offset=\"index % 2 == 0 ? 0 : 2\"\r\n                  v-for=\"(item,index) in list\"\r\n              >\r\n                <el-card  style=\"margin-top: 20px; width: 500px;\">\r\n                  <el-row>\r\n                    <el-col :span=\"6\">车辆标号：</el-col>\r\n                    <el-col :span=\"5\">{{index + 1}}</el-col>\r\n                  </el-row>\r\n                  <el-row>\r\n                    <el-col :span=\"6\">本车排队代码：</el-col>\r\n                    <el-col :span=\"5\">{{ item.number }}</el-col>\r\n                  </el-row>\r\n                  <el-row>\r\n                    <el-col :span=\"6\">前车等待数量：</el-col>\r\n                    <el-col :span=\"5\">{{ item.carsAhead }}</el-col>\r\n                  </el-row>\r\n                  <el-row>\r\n                    <el-col :span=\"6\">当前所在区域：</el-col>\r\n                    <el-col :span=\"5\">{{ item.area }}</el-col>\r\n                  </el-row>\r\n                  <el-row>\r\n                    <el-col :span=\"6\">（预期/正在）使用充电桩：</el-col>\r\n                    <el-col :span=\"5\">{{ item.chargePileID }}</el-col>\r\n                  </el-row>\r\n                  <el-row>\r\n                    <el-col :span=\"6\">等待前车进度：</el-col>\r\n                    <el-col :span=\"5\">\r\n                      <el-progress\r\n                          :text-inside=\"true\"\r\n                          :stroke-width=\"20\"\r\n                          :percentage=\"item.car_per\"\r\n                          status=\"exception\"\r\n                          color=\"blue\"\r\n                      >\r\n                        <span>排队进度</span>\r\n                      </el-progress>\r\n                    </el-col>\r\n                  </el-row>\r\n                  <el-row>\r\n                    <el-col :span=\"6\">汽车充电进度：</el-col>\r\n                    <el-col :span=\"5\">\r\n                      <el-progress type=\"dashboard\" :percentage=\"item.ele_per\" :indeterminate=\"true\">\r\n                        <template #default=\"{ percentage }\">\r\n                          <span class=\"percentage-value\">{{ percentage.toFixed(2) }}%</span>\r\n\r\n                        </template>\r\n                      </el-progress>\r\n                    </el-col>\r\n                  </el-row>\r\n                  <button>结束充电</button>\r\n                </el-card>\r\n              </el-col>\r\n            </el-row>\r\n\r\n            <div>\r\n              <button @click=\"test\">test</button>\r\n            </div>\r\n          </div>\r\n          <div>\r\n            {{menu}}\r\n          </div>\r\n\r\n        </el-main>\r\n      </el-container>\r\n    </div>\r\n\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n  name: \"Test\",\r\n  data() {\r\n    return {\r\n      userName: window.localStorage.getItem(\"userName\"),\r\n      logoUrl: \"../assets/images/logo.png\",\r\n      isAdmin: window.localStorage.getItem(\"isAdmin\"),\r\n      index: 1,\r\n      form: {\r\n        name: '',\r\n        region: '',\r\n        date1: '',\r\n        date2: '',\r\n        delivery: false,\r\n        type: [],\r\n        resource: '',\r\n        desc: ''\r\n      },\r\n      order: {\r\n        name: window.localStorage.getItem(\"userName\"),\r\n        id: window.localStorage.getItem(\"id\"),\r\n        requestVol: 0,\r\n        startVol: 0,\r\n        chargingMode: \"\",\r\n        carVol: 0\r\n      },\r\n      carStatus: 0,\r\n      chargePileID: \"暂未加入排队序列\",\r\n      carsAhead: \"暂未加入排队序列\",\r\n      queueNo: 0,\r\n      number: \"暂未加入排队序列\",\r\n      area: \"暂未加入排队序列\",\r\n      car_per: 0,\r\n      ele_per: 0,\r\n      totalCar: 0,\r\n      isRunning: false,\r\n      timer: null,\r\n      timer2: null,\r\n      vol: 0,\r\n      menu: {},\r\n      timerList: [],\r\n      timerList2: [],\r\n      list: [],\r\n      ceshi: []\r\n    }\r\n  },\r\n  created() {\r\n\r\n  },\r\n  mounted() {\r\n\r\n  },\r\n  methods: {\r\n\r\n    test() {\r\n      var _this = this\r\n      var i = 0\r\n      var timer = setInterval(function (){\r\n        if (i == 5){\r\n          window.clearInterval(timer)\r\n        }\r\n        var j = i + 3\r\n        var temp = {}\r\n        temp.name = j + ''\r\n        temp.id = j\r\n        temp.requestVol = 10\r\n        temp.chargingMode = 'F'\r\n        temp.modeChoose = 'A'\r\n        temp.time = '2022/6/16 13:56:00'\r\n\r\n        _this.startTest(i, temp)\r\n\r\n        i ++\r\n      }, 2000)\r\n\r\n    },\r\n    startTest(i, order){\r\n      var _this = this\r\n      _this.ceshi.push(order)\r\n      switch (order.modeChoose){\r\n        case 'A':\r\n          _this.onSubmit(i, order)\r\n          break;\r\n        case 'B':\r\n          _this.fix(i, order)\r\n          break;\r\n        case 'C':\r\n          _this.change(i, order)\r\n          break;\r\n      }\r\n    },\r\n    sleep(numberMillis) {\r\n      var now = new Date();\r\n      var exitTime = now.getTime() + numberMillis;\r\n      while (true) {\r\n        now = new Date();\r\n        if (now.getTime() > exitTime)\r\n          return true;\r\n      }\r\n    },\r\n\r\n    cancle() {\r\n      var _this = this\r\n      axios.post('http://127.0.0.1:5000/usr/cancel', _this.order).then(\r\n          function (response) {\r\n            window.clearInterval(_this.timer)\r\n            window.clearInterval(_this.timer2)\r\n            _this.isRunning = false\r\n          }\r\n      )\r\n    },\r\n    perSecond(i) {\r\n      const _this = this\r\n      axios.post('http://127.0.0.1:5000/usr/car-status', _this.list[i].order).then(\r\n          function (response) {\r\n            _this.list[i].carsAhead = response.data.carsAhead\r\n            console.log(\"V\", i+1, response.data)\r\n            switch (response.data.carStatus) {\r\n              case 3:\r\n                _this.list[i].area = \"优先等待区\"\r\n                break;\r\n              case 2:\r\n                _this.list[i].area = \"等待区\"\r\n                break;\r\n              case 1:\r\n                _this.list[i].number = null\r\n                _this.list[i].carsAhead = null\r\n                _this.list[i].area = \"充电等待区\"\r\n                break;\r\n              default:\r\n                _this.list[i].area = \"充电区\"\r\n                break;\r\n            }\r\n            _this.list[i].chargePileID = response.data.chargePileID\r\n\r\n            switch (response.data.status){\r\n              case 'charging':\r\n                window.clearInterval(_this.timerList[i])\r\n                axios.post('http://127.0.0.1:5000/usr/start-charging', _this.list[i].order).then(\r\n                    function (response) {\r\n                      _this.list[i].queueNo = null\r\n                      console.log(\"V\", i+1, response.data)\r\n                      switch (response.data.carStatus) {\r\n                        case 3:\r\n                          _this.list[i].area = \"优先等待区\"\r\n                          break;\r\n                        case 2:\r\n                          _this.list[i].area = \"等待区\"\r\n                          break;\r\n                        case 1:\r\n                          _this.list[i].area = \"充电等待区\"\r\n                          break;\r\n                        default:\r\n                          _this.list[i].area = \"充电区\"\r\n                          break;\r\n                      }\r\n                      _this.timerList2[i] = setInterval(function () {\r\n                        _this.perSecond2(i)\r\n                      }, 1000)\r\n                    }\r\n                )\r\n            }\r\n          }\r\n      )\r\n    },\r\n    perSecond2(i) {\r\n      const _this = this\r\n      axios.post('http://127.0.0.1:5000/usr/car-status', _this.list[i].order).then(\r\n          function (response) {\r\n            _this.list[i].number = null\r\n            _this.list[i].chargePileID = response.data.chargePileID\r\n            switch (response.data.carStatus) {\r\n              case 3:\r\n                _this.list[i].carsAhead = response.data.carsAhead\r\n                _this.list[i].area = \"优先等待区\"\r\n                break;\r\n              case 2:\r\n                _this.list[i].area = \"等待区\"\r\n                break;\r\n              case 1:\r\n                _this.list[i].number = null\r\n                _this.list[i].carsAhead = null\r\n                _this.list[i].area = \"充电等待区\"\r\n                break;\r\n              default:\r\n                _this.list[i].area = \"充电区\"\r\n                break;\r\n            }\r\n            if (response.data.status === 'charging-finished'){\r\n              _this.list[i].carsAhead = response.data.carsAhead\r\n              _this.list[i].chargePileID = response.data.chargePileID\r\n              window.clearInterval(_this.timerList2[i])\r\n              // _this.list[i] = null\r\n              console.log(\"V\", i+1, response.data)\r\n              axios.post('http://127.0.0.1:5000/usr/end-charging', _this.list[i].order).then(\r\n                  function (response) {\r\n                    console.log(\"V\", i+1, response.data.status)\r\n                    _this.list[i].area = '离开'\r\n                    _this.list[i].chargePileID = null\r\n                    _this.list[i].carsAhead = null\r\n                    _this.isRunning = false\r\n                    _this.menu = response.data\r\n                  }\r\n              ).catch(\r\n                  function (err){\r\n                    console.log(err)\r\n                  }\r\n              )\r\n            }\r\n            else if (response.data.status === 'charging'){\r\n              _this.list[i].vol += response.data.incVol\r\n              _this.list[i].ele_per = (_this.list[i].vol / _this.list[i].carVol) * 100\r\n            }\r\n            else if (response.data.status === 'prewaiting'){\r\n\r\n            }\r\n            else {\r\n\r\n            }\r\n          }\r\n      )\r\n    },\r\n    handleSelect(key, keyPath) {\r\n      this.index = key\r\n    },\r\n    onSubmit(i, order) {\r\n      var mode = [100, 150, 200, 250, 300]\r\n      var _this = this\r\n      _this.order.carVol = mode[Math.floor(Math.random() * 5)]\r\n      _this.order.startVol = Math.floor(Math.random() * (order.carVol + 1))\r\n      _this.vol = order.startVol\r\n      axios.post('http://127.0.0.1:5000/usr/getqueueno', order).then(\r\n          function (response) {\r\n            let data = response.data\r\n            _this.carStatus = data.carStatus\r\n            _this.chargePileID = data.chargePileID\r\n            _this.carsAhead = data.carsAhead + \"\"\r\n            _this.queueNo = data.queueNo\r\n            _this.number = data.carsAhead + 1 + \"\"\r\n            _this.totalCar = data.carsAhead + 1\r\n            _this.car_per = (data.carsAhead + 1 - data.carsAhead) / (data.carsAhead + 1) * 100\r\n            _this.ele_per = (_this.order.startVol / _this.order.carVol) * 100\r\n            _this.isRunning = true\r\n            switch (data.carStatus) {\r\n              case 3:\r\n                _this.area = \"优先等待区\"\r\n                break;\r\n              case 2:\r\n                _this.area = \"等待区\"\r\n                break;\r\n              case 1:\r\n                _this.area = \"充电等待区\"\r\n                break;\r\n              default:\r\n                _this.area = \"充电区\"\r\n                break;\r\n            }\r\n            var obj = {}\r\n            obj.number = data.carsAhead + 1 + \"\"\r\n            obj.carsAhead = data.carsAhead + \"\"\r\n            obj.area = _this.area\r\n            obj.chargePileID = data.chargePileID\r\n            obj.car_per = (data.carsAhead + 1 - data.carsAhead) / (data.carsAhead + 1) * 100\r\n\r\n            obj.carVol = mode[Math.floor(Math.random() * 5)]\r\n            obj.startVol = Math.floor(Math.random() * (obj.carVol + 1))\r\n            obj.ele_per = (obj.startVol / obj.carVol) * 100\r\n            obj.vol = obj.startVol\r\n            obj.order = order\r\n            obj.order.startVol = obj.startVol\r\n            obj.order.carVol = obj.carVol\r\n            _this.list.push(obj)\r\n            _this.timerList[i] = setInterval(function () {\r\n              _this.perSecond(i)\r\n            }, 1000)\r\n\r\n          }\r\n      )\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.chat {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 200%;\r\n  z-index: -1;\r\n\r\n  background-image: linear-gradient(45deg, rgba(0, 200, 255, 0.4) 0%, rgba(132, 43, 171, 0.4) 100%);\r\n}\r\n\r\n#title {\r\n  color: white;\r\n  position: center !important;\r\n}\r\n\r\n.contain {\r\n  background: rgba(34, 34, 34, 0.5) !important;\r\n}\r\n\r\n.m-card {\r\n  margin-right: 40px;\r\n  background-image: linear-gradient(45deg, rgba(0, 200, 255, 0.4) 0%, rgba(132, 43, 171, 0.4) 100%);\r\n}\r\n\r\n.ourpage {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  z-index: -1;\r\n  border-radius: 5px;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}